<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LeadHunter — Sender Campaigns</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link
  href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&amp;family=Fira+Sans:wght@300;400;500;600;700&amp;display=swap"
  rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="tailwind-config.js"></script>
<link rel="stylesheet" href="styles.css?v=light">




<!-- Sidebar (Cloned exactly from dashboard.html for seamless navigation) -->

<!-- Sidebar -->
<aside
  class="w-[220px] border-r flex flex-col fixed inset-y-0 left-0 z-50 bg-white/80 backdrop-blur-xl border-slate-200 shadow-[0_8px_32px_rgba(31,38,135,0.07)]">
  <div
    class="flex items-center gap-3 p-5 pb-4 border-b text-brand-primary font-bold text-lg tracking-tight border-slate-200">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round" class="shrink-0 drop-shadow-[0_0_8px_rgba(59,130,246,0.5)]">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
      <path d="M11 8v6M8 11h6"></path>
    </svg>
    <span>LeadHunter</span>
  </div>
  <nav class="flex-1 p-3 flex flex-col gap-1.5 overflow-y-auto">
    <a href="/dashboard.html"
      class="flex items-center gap-2.5 px-3 py-2 rounded-md font-medium transition-all text-brand-secondary hover:bg-brand-hover hover:text-brand-text border border-transparent">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <rect x="2" y="3" width="20" height="14" rx="2"></rect>
        <path d="M8 21h8M12 17v4"></path>
      </svg>
      Scraper
    </a>
    <a href="/sender.html" id="navSender"
      class="flex items-center gap-2.5 px-3 py-2 rounded-md font-medium transition-all bg-brand-primary/10 text-brand-primary border border-brand-primary/30 shadow-[inset_0_1px_0_rgba(255,255,255,0.05)] cursor-default">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="m22 2-7 20-4-9-9-4Z"></path>
        <path d="M22 2 11 13"></path>
      </svg>
      Sender
    </a>
    <a href="/categories.html"
      class="flex items-center gap-2.5 px-3 py-2 rounded-md font-medium transition-all text-brand-secondary hover:bg-brand-hover hover:text-brand-text border border-transparent">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path>
      </svg>
      Categories
    </a>
    <a href="/checker.html" id="navChecker"
      class="flex items-center gap-2.5 px-3 py-2 rounded-md font-medium transition-all text-brand-secondary hover:bg-brand-hover hover:text-brand-text border border-transparent">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 12l2 2 4-4"></path>
        <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"></path>
        <path d="M3 12c1 0 3-1 3-3S4 6 3 6 0 7 0 9s2 3 3 3"></path>
        <path d="M12 3c0 1-1 3-3 3S6 4 6 3s1-3 3-3 3 2 3 3"></path>
        <path d="M12 21c0-1-1-3-3-3s-3 1-3 3 1 3 3 3 3-2 3-3"></path>
      </svg>
      Checker
    </a>

    <!-- Sticky Upgrade CTA -->
    <a href="/index.html#pricing"
      class="flex items-center gap-2.5 px-3 py-2 mt-auto mb-2 rounded-md font-bold transition-all text-white bg-gradient-to-r from-blue-500 to-indigo-600 shadow-md hover:shadow-lg hover:-translate-y-0.5 border border-transparent">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
        stroke-linecap="round" stroke-linejoin="round">
        <polygon
          points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2">
        </polygon>
      </svg>
      Pro Plans
    </a>
  </nav>
  <div class="p-3 border-t flex flex-col gap-2 bg-slate-50 border-slate-200">
    <div
      class="flex items-center gap-2 px-3 py-2.5 bg-brand-base rounded-md border text-sm text-brand-secondary border-slate-200">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" class="text-brand-primary shrink-0">
        <circle cx="12" cy="8" r="5"></circle>
        <path d="M20 21a8 8 0 1 0-16 0"></path>
      </svg>
      <span id="userInfo" class="truncate font-mono text-xs">Loading...</span>
    </div>
    <button id="logoutBtn"
      class="flex items-center justify-center gap-2 px-3 py-2 w-full text-sm font-medium text-red-500 hover:text-red-400 hover:bg-red-500/10 rounded-md transition-all cursor-pointer border border-transparent hover:border-red-500/20">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
        <polyline points="16 17 21 12 16 7"></polyline>
        <line x1="21" y1="12" x2="9" y2="12"></line>
      </svg>
      Logout
    </button>
  </div>
</aside>


<!-- Main Content Area -->
<div class="ml-[220px] flex-1 flex flex-col min-h-screen">
  <header
    class="h-[64px] backdrop-blur-md border-b flex items-center justify-between px-6 sticky top-0 z-40 bg-white/70 backdrop-blur-xl border-slate-200 shadow-sm">
    <div class="flex items-center gap-4">
      <h1 class="text-xl font-semibold text-brand-text tracking-tight">Campaign Sender</h1>
      <div id="campaignStatusBadge" class="queue-badge" style="display:none;"></div>
    </div>
  </header>

  <div class="dashboard-content">

    <!-- Top KPI Row (Data-Dense Design) -->
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-icon blue-glow">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M22 2L11 13"></path>
            <path d="M22 2L15 22L11 13L2 9L22 2Z"></path>
          </svg>
        </div>
        <div class="metric-info">
          <h4>Total Sent</h4>
          <span class="metric-val" id="kpiTotalSent">0</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-icon green-glow">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <path d="M22 4L12 14.01L9 11.01"></path>
          </svg>
        </div>
        <div class="metric-info">
          <h4>Delivery Rate</h4>
          <span class="metric-val" id="kpiDeliveryRate">0%</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-icon amber-glow">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </div>
        <div class="metric-info">
          <h4>Open Rate</h4>
          <span class="metric-val" id="kpiOpenRate">0%</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-icon purple-glow">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M15 3h6v6"></path>
            <path d="M9 21V9"></path>
            <path d="M9 11h12"></path>
          </svg>
        </div>
        <div class="metric-info">
          <h4>Click Rate</h4>
          <span class="metric-val" id="kpiClickRate">0%</span>
        </div>
      </div>
    </div>

    <!-- Campaign Builder Split View -->
    <div class="campaign-builder-split">
      <!-- LEFT: Configuration -->
      <div class="builder-config border rounded-xl overflow-hidden h-fit flex flex-col gap-4 p-5">
        <div class="pb-3 border-b flex items-center gap-2.5 text-brand-text font-semibold border-slate-200">
          <h2 class="card-title font-semibold text-brand-text m-0 text-base">Compose Campaign</h2>
        </div>

        <div class="form-group">
          <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">Campaign Name <span
              class="required">*</span></label>
          <input type="text" id="campaignName"
            class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
            placeholder="e.g. Q4 Real Estate Outreach">
        </div>

        <div class="form-row">
          <div class="form-group half">
            <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">Sender Name <span
                class="required">*</span></label>
            <input type="text" id="senderName"
              class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
              placeholder="John Doe">
          </div>
          <div class="form-group half">
            <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">Subject Line
              <span class="required">*</span></label>
            <input type="text" id="subjectLine"
              class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
              placeholder="Exclusive Off-Market Deals Inside">
          </div>
        </div>

        <div
          style="background: var(--bg-surface); padding: 16px; border-radius: var(--radius-sm); border: 1px solid var(--border); margin-bottom: 16px;">
          <h4
            style="margin-bottom: 12px; font-size: 14px; color: var(--text-primary); display: flex; align-items: center; gap: 8px;">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            SMTP Configuration <span class="required">*</span>
          </h4>

          <div class="form-row" style="margin-bottom: 12px;">
            <div class="form-group half" style="margin-bottom: 0;">
              <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">SMTP
                Host</label>
              <input type="text" id="smtpHost"
                class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
                placeholder="smtp.gmail.com">
            </div>
            <div class="form-group half" style="margin-bottom: 0; max-width: 100px;">
              <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">Port</label>
              <input type="number" id="smtpPort"
                class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
                placeholder="587" value="587">
            </div>
          </div>

          <div class="form-row" style="margin-bottom: 0;">
            <div class="form-group half" style="margin-bottom: 0;">
              <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">Username
                (Email)</label>
              <input type="text" id="smtpUser"
                class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
                placeholder="you@example.com">
            </div>
            <div class="form-group half" style="margin-bottom: 0;">
              <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">App
                Password</label>
              <input type="password" id="smtpPass"
                class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
                placeholder="••••••••">
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="block text-xs font-semibold text-brand-muted mb-1.5 uppercase tracking-wide">HTML Email Body
            <span class="required">*</span></label>
          <textarea id="htmlTemplate"
            class="w-full px-3 py-2.5 border rounded-md text-sm text-brand-text font-mono focus:outline-none focus:border-brand-primary focus:ring-1 focus:ring-brand-primary/50 transition-all placeholder:text-brand-border border-slate-200 bg-white shadow-sm"
            rows="12" placeholder="<h1>Hi {{firstName}},</h1><p>We saw your property at {{address}}...</p>"></textarea>
          <p class="input-hint">Variables supported. Links will be automatically encoded for tracking.</p>
        </div>

        <div id="senderErrorBox" class="error-box" style="display: none;"></div>

        <button id="btnLaunchCampaign"
          class="mt-2 w-full py-2.5 bg-brand-primary hover:bg-blue-600 text-white rounded-md text-sm font-semibold transition-all duration-200 flex items-center justify-center shadow-glow cursor-pointer gap-2"
          disabled="">
          <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M22 2L11 13"></path>
            <path d="M22 2L15 22L11 13L2 9L22 2Z"></path>
          </svg>
          Launch Campaign
        </button>
      </div>

      <!-- RIGHT: Audience & Targets -->
      <div class="builder-audience border rounded-xl overflow-hidden h-fit flex flex-col gap-4 p-5">
        <div class="pb-3 border-b flex items-center gap-2.5 text-brand-text font-semibold border-slate-200">
          <h2 class="card-title font-semibold text-brand-text m-0 text-base">Target Audience</h2>
        </div>

        <div class="upload-zone relative group overflow-hidden" id="csvDropZone">
          <svg width="32" height="32" fill="none" class="group-hover:stroke-blue-500 transition-colors"
            stroke="var(--blue-primary)" stroke-width="1.5" viewBox="0 0 24 24">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line>
          </svg>
          <h4>Upload Recipients List</h4>
          <p>Drag &amp; drop your <code>.csv</code> or <code>.txt</code> lead file here</p>

          <!-- Native File Input Overlay -->
          <input type="file" id="audienceFile" accept=".csv,.txt"
            class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-50">

          <button
            class="ui-btn-secondary btn-sm mt-2 w-full py-2.5 bg-brand-primary hover:bg-blue-600 text-white rounded-md text-sm font-semibold transition-all duration-200 flex items-center justify-center shadow-glow cursor-pointer gap-2 relative z-10 pointer-events-none"
            id="btnBrowseFile">Browse Files</button>
        </div>

        <div id="audiencePreview" class="audience-preview" style="display:none;">
          <div class="audience-stats">
            <div class="audience-stat-bubble">
              <span class="stat-num" id="parsedCount">0</span>
              <span class="stat-label">Valid Emails</span>
            </div>
            <button
              class="ui-btn-danger btn-icon mt-2 w-full py-2.5 bg-brand-primary hover:bg-blue-600 text-white rounded-md text-sm font-semibold transition-all duration-200 flex items-center justify-center shadow-glow cursor-pointer gap-2"
              id="btnClearAudience" title="Remove Audience">
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                </path>
              </svg>
            </button>
          </div>

          <div class="audience-list-wrapper">
            <table class="data-table dense-table">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="audienceTableBody">
                <!-- JS Injection -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Campaign History Section -->
    <div class="mt-8 border rounded-xl overflow-hidden bg-white shadow-sm mb-12">
      <div class="p-5 border-b flex items-center justify-between bg-slate-50/50">
        <div class="flex items-center gap-2.5">
          <svg width="20" height="20" fill="none" stroke="var(--text-primary)" stroke-width="2" viewBox="0 0 24 24">
            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <h2 class="text-base font-semibold text-brand-text m-0">Campaign History</h2>
        </div>
        <button id="btnRefreshHistory" class="text-xs font-medium text-brand-primary hover:text-blue-600 flex items-center gap-1 transition-colors">
          <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
          </svg>
          Refresh
        </button>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr class="bg-slate-50 text-xs font-semibold text-brand-muted uppercase tracking-wider border-b border-slate-200">
              <th class="px-5 py-3">Campaign Name</th>
              <th class="px-5 py-3">Status</th>
              <th class="px-5 py-3 text-center">Sent</th>
              <th class="px-5 py-3 text-center">Bounced</th>
              <th class="px-5 py-3">Date</th>
              <th class="px-5 py-3">Details / Errors</th>
            </tr>
          </thead>
          <tbody id="historyTableBody" class="text-sm divide-y divide-slate-100">
            <!-- JS Injection -->
            <tr>
              <td colspan="6" class="px-5 py-10 text-center text-brand-muted">
                Loading campaign history...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script type="module" src="app.js"></script>
<script type="module" src="sender.js"></script>